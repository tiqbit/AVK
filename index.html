<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avaliku koosoleku teate esitamine | PPA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #f0f2f5; color: #333; }
        .veera-blue { background-color: #004277; }
        .veera-border { border-color: #004277; }
        .veera-text { color: #004277; }
        .card { background: white; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        input, textarea, select { border: 1px solid #707070; border-radius: 3px; padding: 8px 12px; width: 100%; }
        input:focus { outline: 2px solid #004277; border-color: transparent; }
        label { font-weight: 700; display: block; margin-bottom: 5px; font-size: 14px; }
        .step-indicator { display: flex; align-items: center; margin-bottom: 30px; }
        .step { width: 30px; height: 30px; border-radius: 50%; background: #e0e0e0; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 10px; }
        .step.active { background: #004277; color: white; }
    </style>
</head>
<body>

    <!-- Ülariba (Veera/PPA stiilis) -->
    <header class="veera-blue text-white p-4 shadow-md">
        <div class="max-w-5xl mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-4">
                <div class="font-bold text-xl tracking-tight">POLITSEI- JA PIIRIVALVEAMET</div>
            </div>
            <div class="text-sm border-l pl-4 border-blue-400">
                Avaliku koosoleku teatamine
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto py-10 px-4">
        
        <!-- Sammude lugeja -->
        <div class="step-indicator">
            <div class="step active" id="s1">1</div> <span class="mr-6 font-bold">Koosoleku info</span>
            <div class="step" id="s2">2</div> <span class="mr-6">Korraldaja</span>
            <div class="step" id="s3">3</div> <span>Kinnitus</span>
        </div>

        <div class="card p-8">
            <form id="noticeForm">
                
                <!-- 1. OSA: ÜRITUSE INFO -->
                <div id="section1">
                    <h2 class="text-2xl font-bold mb-6 veera-text">Koosoleku andmed</h2>
                    
                    <div class="mb-6">
                        <label for="purpose">Koosoleku vorm ja eesmärk</label>
                        <textarea id="purpose" name="purpose" rows="3" placeholder="Nt: Meeleavaldus keskkonnakaitse toetuseks" required></textarea>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label for="startDate">Alguse kuupäev ja kellaaeg</label>
                            <input type="datetime-local" id="startDate" name="startDate" required>
                            <p class="text-xs text-gray-500 mt-1">Teade tuleb esitada vähemalt 4 tööpäeva ette.</p>
                        </div>
                        <div>
                            <label for="endDate">Eeldatav lõpuaeg</label>
                            <input type="datetime-local" id="endDate" name="endDate" required>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label for="location">Koht või liikumismarsruut</label>
                        <input type="text" id="location" name="location" placeholder="Täpne aadress või tänavate loetelu" required>
                    </div>

                    <div class="flex justify-end">
                        <button type="button" onclick="nextStep(2)" class="veera-blue text-white px-8 py-2 rounded font-bold hover:bg-blue-900 transition">Edasi</button>
                    </div>
                </div>

                <!-- 2. OSA: KORRALDAJA INFO -->
                <div id="section2" class="hidden">
                    <h2 class="text-2xl font-bold mb-6 veera-text">Korraldaja andmed</h2>
                    
                    <div class="bg-blue-50 p-4 mb-6 border-l-4 border-blue-500 text-sm">
                        Infosüsteem on tuvastanud teie isiku läbi TARA teenuse: <strong>JAAN TAMM (38001010000)</strong>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label for="phone">Telefon</label>
                            <input type="tel" id="phone" name="phone" placeholder="+372 ..." required>
                        </div>
                        <div>
                            <label for="email">E-post</label>
                            <input type="email" id="email" name="email" placeholder="nimi@aadress.ee" required>
                        </div>
                    </div>

                    <div class="mb-6 text-sm text-gray-600">
                        <input type="checkbox" id="confirm" class="w-4 h-4 mr-2" required>
                        Kinnitan, et vastan korrakaitseseaduses toodud nõuetele ja tagan koosoleku korra.
                    </div>

                    <div class="flex justify-between">
                        <button type="button" onclick="nextStep(1)" class="border border-gray-400 px-8 py-2 rounded font-bold hover:bg-gray-100">Tagasi</button>
                        <button type="submit" class="bg-green-600 text-white px-8 py-2 rounded font-bold hover:bg-green-700 transition">Esita teade politseile</button>
                    </div>
                </div>
            </form>

            <!-- 3. OSA: EDUKAS SAATMINE -->
            <div id="section3" class="hidden text-center py-10">
                <div class="text-green-600 text-6xl mb-4">✓</div>
                <h2 class="text-2xl font-bold mb-2">Teade on edukalt esitatud!</h2>
                <p class="text-gray-600 mb-6">Teade on edastatud Põhja prefektuuri korrapidajale. Teate number: #PPA-2024-8812</p>
                <button onclick="location.reload()" class="veera-blue text-white px-8 py-2 rounded font-bold">Tagasi algusesse</button>
            </div>

        </div>

        <div class="mt-8 text-xs text-gray-500 text-center">
            Süsteem on ühilduv Payload CMS API-ga. Andmeid käideldakse vastavalt isikuandmete kaitse seadusele.
        </div>
    </main>

    <script>
        function nextStep(step) {
            document.getElementById('section1').classList.add('hidden');
            document.getElementById('section2').classList.add('hidden');
            document.getElementById('section3').classList.add('hidden');
            
            document.getElementById('section' + step).classList.remove('hidden');
            
            // Uuenda sammude täppe
            document.getElementById('s1').classList.remove('active');
            document.getElementById('s2').classList.remove('active');
            if(step <= 2) document.getElementById('s' + step).classList.add('active');
        }

        document.getElementById('noticeForm').onsubmit = function(e) {
            e.preventDefault();
            
            // Simuleerime andmete saatmist Payload CMS-i
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());
            
            console.log("Saadan andmed Payload CMS API-sse:", data);
            
            nextStep(3);
        };

        // Automaatne kuupäeva piirang: täna + 4 päeva
        const dateInput = document.getElementById('startDate');
        const minDate = new Date();
        minDate.setDate(minDate.getDate() + 4);
        dateInput.min = minDate.toISOString().slice(0, 16);
    </script>
</body>
</html>
